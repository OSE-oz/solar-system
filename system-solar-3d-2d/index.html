<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>3D/2D Solar System Hybrid</title>
  <style>
    body { margin: 0; overflow: hidden; background: black; }
    canvas { display: block; position: absolute; top: 0; left: 0; }
    #canvas2D { z-index: 1; }
    #canvas3D { z-index: 0; }
    p { position: absolute; top: 10px; left: 10px; color: white; font-family: Arial, sans-serif; z-index: 2; }
  </style>
</head>
<body>
<p>click with mouse to change 3d to 2d</p>
<!-- Canvas for 2D view -->
<canvas id="canvas2D"></canvas>

<!-- Script for 3D (Three.js) -->
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
  // ======== 3D SETUP ========
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
  camera.position.z = 100;

  const renderer3D = new THREE.WebGLRenderer({ antialias: true, canvas: document.createElement('canvas') });
  renderer3D.setSize(window.innerWidth, window.innerHeight);
  renderer3D.domElement.id = 'canvas3D';
  document.body.appendChild(renderer3D.domElement);

  const light = new THREE.PointLight(0xffffff, 2, 1000);
  light.position.set(0, 0, 0);
  scene.add(light);

  const sun = new THREE.Mesh(
    new THREE.SphereGeometry(10, 32, 32),
    new THREE.MeshBasicMaterial({ color: 0xffaa00 })
  );
  scene.add(sun);

  function createPlanet(radius, size, color) {
    const geo = new THREE.SphereGeometry(size, 32, 32);
    const mat = new THREE.MeshStandardMaterial({ color });
    const mesh = new THREE.Mesh(geo, mat);
    mesh.userData = { radius, angle: Math.random() * Math.PI * 2 };
    scene.add(mesh);
    return mesh;
  }

  const planets3D = [
    createPlanet(20, 1, 0x888888),
    createPlanet(30, 1.5, 0xd2b48c),
    createPlanet(40, 2, 0x3b82f6),
    createPlanet(50, 1.5, 0xff5733),
    createPlanet(65, 4, 0xf5b041),
    createPlanet(80, 3.5, 0xf4d03f),
    createPlanet(95, 2.5, 0x85c1e9),
    createPlanet(110, 2.5, 0x5dade2),
  ];

  const moon3D = new THREE.Mesh(
    new THREE.SphereGeometry(0.5, 16, 16),
    new THREE.MeshStandardMaterial({ color: 0xdddddd })
  );
  moon3D.userData = { radius: 4, angle: 0 };
  scene.add(moon3D);

  function animate3D() {
    planets3D.forEach((planet, index) => {
      const speed = 0.01 + index * 0.001;
      planet.userData.angle += speed;
      const r = planet.userData.radius;
      planet.position.x = Math.cos(planet.userData.angle) * r;
      planet.position.z = Math.sin(planet.userData.angle) * r;

      if (index === 2) {
        moon3D.userData.angle += 0.03;
        moon3D.position.x = planet.position.x + Math.cos(moon3D.userData.angle) * moon3D.userData.radius;
        moon3D.position.z = planet.position.z + Math.sin(moon3D.userData.angle) * moon3D.userData.radius;
        moon3D.position.y = planet.position.y;
      }
    });

    renderer3D.render(scene, camera);
  }

  // ======== 2D SETUP ========
  const canvas2D = document.getElementById("canvas2D");
  const ctx = canvas2D.getContext("2d");

  canvas2D.width = window.innerWidth;
  canvas2D.height = window.innerHeight;

  const centerX = canvas2D.width / 2;
  const centerY = canvas2D.height / 2;

  const sun2D = { size: 30, color: "orange" };

  const planets2D = [
    { name: "Mercury", radius: 50, size: 3, speed: 0.04, color: "#aaa", angle: 0 },
    { name: "Venus", radius: 90, size: 5, speed: 0.03, color: "#d3c9a5", angle: 0 },
    { name: "Earth", radius: 130, size: 6, speed: 0.02, color: "#3b82f6", angle: 0 },
    { name: "Mars", radius: 170, size: 5, speed: 0.018, color: "#f87171", angle: 0 },
    { name: "Jupiter", radius: 220, size: 10, speed: 0.01, color: "#fbbf24", angle: 0 },
    { name: "Saturn", radius: 270, size: 9, speed: 0.008, color: "#facc15", angle: 0 },
    { name: "Uranus", radius: 320, size: 7, speed: 0.006, color: "#60a5fa", angle: 0 },
    { name: "Neptune", radius: 370, size: 7, speed: 0.005, color: "#6366f1", angle: 0 },
  ];

  const moon2D = {
    orbitRadius: 15,
    size: 2,
    speed: 0.08,
    angle: 0,
    color: "#ccc"
  };

  function draw2D() {
    ctx.clearRect(0, 0, canvas2D.width, canvas2D.height);
    ctx.beginPath();
    ctx.arc(centerX, centerY, sun2D.size, 0, Math.PI * 2);
    ctx.fillStyle = sun2D.color;
    ctx.shadowColor = 'orange';
    ctx.shadowBlur = 20;
    ctx.fill();
    ctx.shadowBlur = 0;

    planets2D.forEach((planet) => {
      planet.angle += planet.speed;
      const x = centerX + Math.cos(planet.angle) * planet.radius;
      const y = centerY + Math.sin(planet.angle) * planet.radius;

      ctx.beginPath();
      ctx.arc(centerX, centerY, planet.radius, 0, Math.PI * 2);
      ctx.strokeStyle = "rgba(255,255,255,0.1)";
      ctx.stroke();

      ctx.beginPath();
      ctx.arc(x, y, planet.size, 0, Math.PI * 2);
      ctx.fillStyle = planet.color;
      ctx.fill();

      if (planet.name === "Earth") {
        moon2D.angle += moon2D.speed;
        const mx = x + Math.cos(moon2D.angle) * moon2D.orbitRadius;
        const my = y + Math.sin(moon2D.angle) * moon2D.orbitRadius;

        ctx.beginPath();
        ctx.arc(x, y, moon2D.orbitRadius, 0, Math.PI * 2);
        ctx.stroke();

        ctx.beginPath();
        ctx.arc(mx, my, moon2D.size, 0, Math.PI * 2);
        ctx.fillStyle = moon2D.color;
        ctx.fill();
      }
    });

    requestAnimationFrame(draw2D);
  }

  // ======== RENDER LOOP CONTROL ========
  let in3DMode = true;
  function loop() {
    if (in3DMode) {
      animate3D();
    }
    requestAnimationFrame(loop);
  }

  loop();
  draw2D();
  canvas2D.style.display = "none"; // Hide 2D initially

  // Toggle between modes
  window.addEventListener("click", () => {
    in3DMode = !in3DMode;
    renderer3D.domElement.style.display = in3DMode ? "block" : "none";
    canvas2D.style.display = in3DMode ? "none" : "block";
  });

  // Resize support
  window.addEventListener("resize", () => {
    renderer3D.setSize(window.innerWidth, window.innerHeight);
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();

    canvas2D.width = window.innerWidth;
    canvas2D.height = window.innerHeight;
  });
</script>
</body>
</html>
